import{j as e,B as N,b as f,r as c,ar as W,z as $,F as J,G as u,J as _,O as U,d as g,L as D,E as q}from"./index-e6b236b7.js";import{B as H,a as I,d as K,b as Q,D as X,N as Y,m as Z}from"./MassDeleteAPI-bd544692.js";import{g as O}from"./ProductsAPI-913b3a6a.js";import{g as ee,b as te,c as ae}from"./OrderAPI-9fb99190.js";import{C as re}from"./LastPage-2c13744c.js";import"./index-4d501b15.js";import"./ListItemText-f4558710.js";import"./SwitchBase-e410cf0a.js";import"./IconButton-398895cd.js";function ie(r){function h(m){m==0?O(r.setIsLoading).then(l=>{r.setIsLoading(!0);let a=[];l.forEach(i=>{a.push({id:i.id,product_name:i.name,price:i.price,catagory:i.catagory})}),r.setrowValue(a),r.setIsLoading(!1)}):m==1&&ee(r.setIsLoading).then(l=>{let a=[],i=[];l.forEach(n=>{a.push({id:n.id,username:n.user,email:n.email,view:"Click me!",totalPrice:n.total_price,deliveryStatus:n.delivery_status}),i.push(n)}),r.setrowValue(a),r.setRowDetail(i),r.setIsLoading(!1)})}return e(N,{sx:{width:800},children:f(H,{showLabels:!0,value:r.navValue,onChange:(m,l)=>{h(l),r.setNavValue(l)},children:[e(I,{label:"Products",icon:e(K,{})}),e(I,{label:"Orders",icon:e(Q,{})})]})})}function fe(r){const[h,m]=c.useState(0),[l,a]=c.useState(!1),[i,n]=c.useState(),[b,k]=c.useState([]),[S,x]=c.useState(),[L,P]=c.useState(!1),[y,C]=c.useState(!1),[p,w]=c.useState(!1),j=()=>{w(!0)},E=()=>{w(!1)},V=W(),R=$(),A=[{field:"id",headerName:"ID",width:70},{field:"username",headerName:"User",width:70},{field:"email",headerName:"Email",width:200},{field:"view",headerName:"View Order",renderCell:t=>e("strong",{children:e(g,{variant:"contained",size:"small",style:{marginLeft:16},tabIndex:t.hasFocus?0:-1,onClick:()=>{x(t.id),j()},children:"Open"})}),width:120},{field:"totalPrice",headerName:"Total Price",type:"number",width:100},{field:"deliveryStatus",headerName:"Delivery Status",width:150},{field:"dispatch",headerName:"Dispatched?",renderCell:t=>{let o;return t.row.deliveryStatus=="Dispatched"?o=!0:o=!1,e("strong",{children:e(re,{checked:o,onChange:d=>{const s=t.id,v=d.target.checked;te(a,s).then(M=>{ae(a,s,M,v).then(T=>{l||(t.row.deliveryStatus=T.delivery_status)})})}})})},width:120}],B=[{field:"id",headerName:"ID",width:70},{field:"product_name",headerName:"Product",width:90},{field:"price",headerName:"Price",width:90},{field:"catagory",headerName:"Catagory",type:"number",width:150},{field:"detailed_view",headerName:"View details",type:"number",width:150}];c.useEffect(()=>{let t=localStorage.getItem("username");t!=null&&(V(`/account/${t}/`,{replace:!0}),n([])),O(a).then(o=>{a(!0);let d=[];o.forEach(s=>{d.push({id:s.id,product_name:s.name,price:s.price,catagory:s.catagory})}),n(d),a(!1)})},[]);function z(){const t=[...b],o=i;let d=[...i],s=0;R(q.changeItem(["delete",t])),o.forEach(v=>{t.includes(v.id)&&d.splice(s,1),s++}),n(d),Z(a,"cart",t)}function G(){localStorage.removeItem("Token"),localStorage.removeItem("username"),localStorage.removeItem("isLogged"),localStorage.removeItem("user_id"),localStorage.removeItem("user_status"),r.logOut(!1)}function F(t){return t.id==S}return f(J,{children:[l?e(u,{container:!0,justifyContent:"center",children:e(_,{size:"25rem",sx:{margin:"auto"}})}):i==null?e(u,{container:!0,justifyContent:"center",children:e(_,{size:"25rem",sx:{margin:"auto"}})}):e(N,{height:"100vh",children:e(U,{maxWidth:"lg",children:f(u,{padding:"2rem 0",container:!0,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,children:[f(u,{item:!0,justifyContent:"center",children:["Welcome back, ",localStorage.getItem("username")]}),e(u,{item:!0,container:!0,justifyContent:"center",children:e(ie,{setIsLoading:a,setrowValue:n,setNavValue:m,navValue:h,setRowDetail:P})}),e(u,{item:!0,container:!0,justifyContent:"center",width:"75vw",children:e("div",{style:{height:400,width:"60%"},children:e(X,{rows:i,columns:h==0?B:A,pageSize:5,rowsPerPageOptions:[5],checkboxSelection:!0,disableSelectionOnClick:!0,disableColumnSelector:!0,onSelectionModelChange:t=>{const o=new Set(t);k(o),[...o].length==0?C(!1):C(!0)}})})}),f(u,{item:!0,container:!0,justifyContent:y?"space-between":"space-evenly",height:.2,width:.5,children:[y?e(g,{variant:"contained",sx:{color:"red"},onClick:z,children:"Delete items"}):"",h==0?e(g,{variant:"contained",component:D,to:"create/product",children:"Add Product"}):"",e(g,{variant:"contained",component:D,to:"/account/login",onClick:G,children:"Log out"})]})]})})}),h==1&&e(Y,{open:p,setOpen:w,handleClose:E,rowDetail:p&&L.filter(F),checkOrderId:S})]})}export{fe as default};
