import{j as e,B as P,b as w,C as V,r as o,ar as $,z as J,E as k,F as Q,G as d,J as L,O as H,d as b,L as K}from"./index-e6b236b7.js";import{B as U,a as j,d as X,b as Y,D as Z,N as ee,m as te}from"./MassDeleteAPI-bd544692.js";import{g as re}from"./OrderAPI-9fb99190.js";import"./index-4d501b15.js";import"./ListItemText-f4558710.js";import"./LastPage-2c13744c.js";import"./SwitchBase-e410cf0a.js";import"./IconButton-398895cd.js";function ae(t){function h(m){m==0?V(t.setIsLoading).then(s=>{t.setIsLoading(!0);let i=[];for(const[n,r]of Object.entries(s)){const v=n.slice(n.lastIndexOf(" ")+1,n.length),C=Number(r.product.price),f=Number(r.quantity),p=(C*f).toFixed(2);i.push({id:v,product:r.product.name,quantity:f,totalPrice:p})}t.setrowValue(i),t.setIsLoading(!1)}):m==1&&(t.setIsLoading(!0),re(t.setIsLoading).then(s=>{let i=[],n=[];s.forEach(r=>{i.push({id:r.id,view:"Click me!",totalPrice:r.total_price,deliveryStatus:r.delivery_status}),n.push(r)}),t.setrowValue(i),t.setOrderRowDetail(n),t.setIsLoading(!1)}))}return e(P,{sx:{width:500},children:w(U,{showLabels:!0,value:t.navValue,onChange:(m,s)=>{h(s),t.setNavValue(s)},children:[e(j,{label:"Cart",icon:e(X,{})}),e(j,{label:"Orders",icon:e(Y,{})})]})})}function he(t){const[h,m]=o.useState(0),[s,i]=o.useState(!1),[n,r]=o.useState(),[v,C]=o.useState([]),[f,p]=o.useState(),[B,R]=o.useState(!1),[I,O]=o.useState(!1),[_,y]=o.useState(!1),q=()=>{y(!0)},z=()=>{y(!1)};$();const N=J(),E=[{field:"id",headerName:"ID",width:70},{field:"view",headerName:"View Order",renderCell:a=>e("strong",{children:e(b,{variant:"contained",size:"small",style:{marginLeft:16},tabIndex:a.hasFocus?0:-1,onClick:()=>{p(a.id),q()},children:"Open"})}),width:120},{field:"totalPrice",headerName:"Total Price",type:"number",width:150},{field:"deliveryStatus",headerName:"Delivery Status",width:150}],F=[{field:"id",headerName:"ID",width:70},{field:"product",headerName:"Product",width:90},{field:"quantity",headerName:"Quantity",width:90},{field:"totalPrice",headerName:"Total Price",type:"number",width:150}];o.useEffect(()=>{V(i).then(a=>{i(!0);let c=[],g=[];for(const[u,l]of Object.entries(a)){const D=u.slice(u.lastIndexOf(" ")+1,u.length),M=`card${l.product.id}`,W=Number(l.product.price),S=Number(l.quantity),x=(W*S).toFixed(2);c.push({key:M,...l.product,quantity:S,price:x,data_id:D}),g.push({id:D,product:l.product.name,quantity:S,totalPrice:x})}N(k.replaceCart(c)),r(g),i(!1)})},[]);function G(){const a=[...v],c=n;let g=[...n],u=0;N(k.changeItem(["delete",a])),c.forEach(l=>{a.includes(l.id)&&g.splice(u,1),u++}),r(g),te(i,"cart",a)}function A(){localStorage.removeItem("Token"),localStorage.removeItem("username"),localStorage.removeItem("isLogged"),localStorage.removeItem("user_id"),localStorage.removeItem("user_status"),t.logOut(!1)}function T(a){return a.id==f}return w(Q,{children:[s?e(d,{container:!0,justifyContent:"center",children:e(L,{size:"25rem",sx:{margin:"auto"}})}):n==null?e(d,{container:!0,justifyContent:"center",children:e(L,{size:"25rem",sx:{margin:"auto"}})}):e(P,{height:"100vh",children:e(H,{maxWidth:"lg",children:w(d,{padding:"2rem 0",container:!0,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,children:[w(d,{item:!0,justifyContent:"center",children:["Welcome back, ",localStorage.getItem("username")]}),e(d,{item:!0,container:!0,justifyContent:"center",children:e(ae,{setIsLoading:i,setrowValue:r,setNavValue:m,navValue:h,setOrderRowDetail:R})}),e(d,{item:!0,container:!0,justifyContent:"center",width:"75vw",children:e("div",{style:{height:400,width:"60%"},children:e(Z,{rows:n,columns:h==0?F:E,pageSize:5,rowsPerPageOptions:[5],checkboxSelection:!0,disableSelectionOnClick:!0,disableColumnSelector:!0,onSelectionModelChange:a=>{const c=new Set(a);C(c),[...c].length==0?O(!1):O(!0)}})})}),w(d,{item:!0,container:!0,justifyContent:I?"space-between":"center",width:.2,height:.5,children:[I&&e(b,{variant:"contained",sx:{color:"red"},onClick:G,children:"Delete items"}),e(b,{variant:"contained",component:K,to:"/account/login",onClick:A,children:"Log out"})]})]})})}),h==1&&e(ee,{open:_,setOpen:y,handleClose:z,rowDetail:_&&B.filter(T),checkOrderId:f})]})}export{he as default};
